{% extends 'base.html.twig' %}


{% block body %}

	<main class="container">
		<section class="row">
			<div class="hero">
				<img src="{{ asset('assets/uploads/hero.jpg') }}" alt="hero" class="img-fluid">
			</div>

			<div class="col-12">
				<h1>PlantEcom</h1>
				<p>Bienvenue sur notre E-Shop</p>
			</div>


			<div class="col-6">
				<h2>Découvrez nos Philodendron</h2>
				<div id="carouselPhilodendron" class="carousel slide" data-bs-ride="carousel" data-bs-interval="3500">
					<div class="carousel-inner">
						<div class="carousel-indicators">
							{% for key, produit in produits|filter(product => product.categories.slug == 'philodendron')|slice(0, 8) %}
								<button type="button" data-bs-target="#carouselPhilodendron" data-bs-slide-to="{{ key }}" {{ (loop.first) ? 'class="active" aria-current="true"' : '' }} aria-label="Slide {{ key }}"></button>
							{% endfor %}
						</div>

						{% for key, produit in produits|filter(product => product.categories.slug == 'philodendron')|slice(0, 8) %}
							<div class="carousel-item {{ loop.first ? 'active' : '' }}">
								{% if produit.getImages|length > 0 %}
									{% set firstImage = produit.getImages.first() %}
									<a href="{{ path('app_products_details', {slug: produit.slug}) }}">
										<img src="{{ asset('assets/uploads/products/' ~ firstImage.name) }}" class="d-block w-100" alt="{{ produit.name }}">
										<div class="carousel-caption d-none d-md-block">
											<h5>{{ produit.name }}</h5>
											<p>{{ produit.price }}
												€</p>
										</div>
									</a>
								{% endif %}
							</div>
						{% endfor %}
					</div>

					<button class="carousel-control-prev" type="button" data-bs-target="#carouselPhilodendron" data-bs-slide="prev">
						<span class="carousel-control-prev-icon" aria-hidden="true"></span>
						<span class="visually-hidden">Previous</span>
					</button>

					<button class="carousel-control-next" type="button" data-bs-target="#carouselPhilodendron" data-bs-slide="next">
						<span class="carousel-control-next-icon" aria-hidden="true"></span>
						<span class="visually-hidden">Next</span>
					</button>
				</div>
			</div>


			<div class="col-6">
				<h2>Découvrez nos Syngonium</h2>
				<div id="carouselSyngonium" class="carousel slide" data-bs-ride="carousel" data-bs-interval="3500">
					<div class="carousel-inner">
						<div class="carousel-indicators">
							{% for key, produit in produits|filter(product => product.categories.slug == 'syngonium')|slice(0, 8) %}
								<button type="button" data-bs-target="#carouselSyngonium" data-bs-slide-to="{{ key }}" {{ (loop.first) ? 'class="active" aria-current="true"' : '' }} aria-label="Slide {{ key }}"></button>
							{% endfor %}
						</div>

						{% for key, produit in produits|filter(product => product.categories.slug == 'syngonium')|slice(0, 8) %}
							<div class="carousel-item {{ loop.first ? 'active' : '' }}">
								{% if produit.getImages|length > 0 %}
									{% set firstImage = produit.getImages.first() %}
									<a href="{{ path('app_products_details', {slug: produit.slug}) }}">
										<img src="{{ asset('assets/uploads/products/' ~ firstImage.name) }}" class="d-block w-100" alt="{{ produit.name }}">
										<div class="carousel-caption d-none d-md-block">
											<h5>{{ produit.name }}</h5>
											<p>{{ produit.price }}
												€</p>
										</div>
									</a>
								{% endif %}
							</div>
						{% endfor %}
					</div>

					<button class="carousel-control-prev" type="button" data-bs-target="#carouselSyngonium" data-bs-slide="prev">
						<span class="carousel-control-prev-icon" aria-hidden="true"></span>
						<span class="visually-hidden">Previous</span>
					</button>

					<button class="carousel-control-next" type="button" data-bs-target="#carouselSyngonium" data-bs-slide="next">
						<span class="carousel-control-next-icon" aria-hidden="true"></span>
						<span class="visually-hidden">Next</span>
					</button>
				</div>
			</div>


			{% for category in categories %}

				{% if category.parent == null %}
					<div class="col-12">
						<h2>
							{{ category.name }}
						</h2>
					</div>

				{% else %}
					<div class="col-3">
						<div class="card">
							<div class="card-body">
								<h3 class="card-title">
									{{category.name}}
								</h3>
								{# TODO : Modifier la source des img sur url et local OU Image d'illustration #}
								{% if category.products|length > 0 %}
									{% set randomProductIndex = random(0, category.products|length - 1) %}
									{% set randomProduct = category.products[randomProductIndex] %}
									{% if randomProduct.getImages|length > 0 %}
										{% set randomImage = randomProduct.getImages.first() %}
										<img src="{{ asset('assets/uploads/products/mini/300x300-' ~ randomImage.name) }}" class="card-img-top" alt="{{ category.name }}">
									{% endif %}
								{% endif %}


								{# {% for produit in produits %}
																							<tr>
																								<td>{{ produit.id }}</td>
																								<td>
																									{% if produit.getImages|length > 0 %}
																    {% set firstImage = produit.getImages.first() %}
																    <img src="{{ asset('assets/uploads/products/mini/300x300-' ~ firstImage.name) }}" width="60%">
																{% endif %} #}

								<a class="btn btn-primary" href="{{path('categories_list', {slug: category.slug }) }}" role="button">Voir les produits</a>
							</div>
						</div>
						<a href="#"></a>
					</div>
				{% endif %}

			{% endfor %}


		</section>
	</main>

{% endblock %}
